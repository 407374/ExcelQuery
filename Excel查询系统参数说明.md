# Excel查询系统参数说明

## 下载区
### 下载区参数详解

1. 数据表名（必填）

   一般为表单的名称，

   查询时可以使用等于、IN、包含，条件

2. 学号/工号

   在指定pid列时，可以查询

3. 姓名

   在指定姓名列时，可以查询

4. 显示字段/不显示字段
    查询时显示部分字段或不显示部分字段，数据库的部分包含密码的敏感数据已被清除。

5. 排序字段
    以哪些字段作为排序的字段，多个字段，中间以英文逗号分隔。

6. 是否升序
    默认都是升序，也可以设为否，这样就是降序了

### 典型的下载查询条件

| 数据表名 | 等于   | 经费使用测试                                             |
| -------- | ------ | -------------------------------------------------------- |
| d5       | 大于等 | 20190101                                                 |
| d5       | 小于等 | 20190514                                                 |
| d1       | 包含   | 费用                                                     |
| d1       | IN     | [12年]5003科研项目费用,[13年]5101设备费,[13年]5109劳务费 |
| 显示字段 | 等于   | d1,d2,d3,d4,d5,d6                                        |
| 排序字段 | 等于   | d4                                                       |
| 是否升序 | 等于   | 否                                                       |

## 密码区
### 密码参数详解
1. 查看密码
    * 有查看密码就可以查看所有的数据。
    建议密码设置的长一些，不用记忆，保存在Excel中即可。建议在这个单元格内填写 “随机”两个字，这样，程序会自动生一个很复杂的10位密码。
2. 上传密码
    * 有上传密码就可以修改数据。
    建议密码设置的长一些，不用记忆，保存在Excel中即可。建议在这个单元格内填写 “随机”两个字，这样，程序会自动生一个很复杂的14位密码。
3. 用户名/用户密码
    * 这是用户在网站中的帐号与密码，在强安全的模式下，必须登陆网站后才能进行下一步的操作。在Excel中提供用户名及密码后，程序会上传至服务器进行校验，成功才能进行下一步。

    * 在程序自动登陆网站的前题下，用户用查看密码进行下载数据或上传密码及其它气操作。
4. 查询网址
就是服务器的网址，如果本地服务器就是 http://127.0.0.1

### 权限
1. 管理员无视用户的查看密码
管理员仅限用户 admin ，在仅知道用户的数据表名的情况下，可以下载数据表的数据。
比较适合多表汇总这种情况
2. 匿名情况下的线权限
用户可以通过上传后的网址直接查询数据，也可以通用网址修改数据。所以请对这个网址保密。
3. 强安全情况下权限
    * 用户在登陆网站后，才可以查询及修改数据；
    * 每个用户在网站中都有自己的查看密码、上传密码；
    * 只能由管理员进行修改用户有密码，以增强安全性。

## 上传区
### 上传参数详解
1. 姓名字段（重要）
    * 查询时如果指定了姓名字段，在线查询时会优先查询对应的数据。
    * 在线查询时，会自动完成提示。
2. ID字段
    * 查询时如果指定了id字段，在线查询时会优先查询对应的数据。
3. 匿名填表
    万能表单的功能，能不能匿名填表。重要的表单可以不充许匿名填写。
4. 分类字段
    在线查询时使用的，把数据分成几类，方便查找。效果如下


### 分类查询：

[学校]() | [台州学院]()

[项目负责人]() | [张三]() | [李四]() | [王五]() | [赵六]()

[项目来源]() | [杰出青年]() | [优秀青年]()

1. 提示字段
    用户输入时，可以自动提示之前输入的数据，方便用户填写。
    可以提前按列输入数据
2. 覆盖上传
    默认是，覆盖上传时，程序会把服务器上的数据全清空，再把现有的数据上传。
    非本覆盖上传时，服务器的数据不清空，直接在后面添加。
### 典型的上传条件

| 姓名字段 | d1          |
| -------- | ----------- |
| ID字段   | d7          |
| 匿名填表 | 是          |
| 分类字段 | d1          |
| 缩略显示 | d5,d2,d4    |
| 提示字段 | d1,d2,d4,d5 |
| 覆盖上传 | 是          |

## 本地参数区
### 本地参数详解
1. 复制到/数据表
    程序默认情况下会把数据下载到  sheet1的 A21单元格，如果想把数据下载的别的单元格，在这里修改即可。
2. 弹窗提示更新
    如果选是，每次打开程序就会提示，是否更新数据，建议用于数据要求最新的情况。

3. 自动下载文件
    * 部分记录中记录了一个附件对应的网址，我们是否想把它下载到本地。
    * 如果数据较多，建议先填否，最后一起下载。

4. 文件名命名规则
    * 可以对下载的数据进行文件名的命名，可以有多个字段，中间用逗号分隔开，这里要用列序号，

5. 下载网址
这是查询数据时对应的URL，用这个URL可以脱离Excel，实现在线输出查询结果。
现在可以实时展示万能表单的结果。
### 典型的本地参数

| 复制到         | A21    |
| -------------- | ------ |
| 数据表         | sheet1 |
| 弹窗提示更新   | 否     |
| 文件名命名规则 | B,A,F  |
| 自动下载文件   | 否     |
| 下载网址       |        |

















